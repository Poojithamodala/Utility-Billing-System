<div class="bills-container">

    <h1 class="title">My Bills</h1>

    <!-- Utility -->
    <div class="tabs">
        <button *ngFor="let utility of utilities" (click)="filterBills(utility)"
            [class.active]="utility === activeUtility">
            {{ utility }}
        </button>
    </div>

    <p *ngIf="loading" class="loading">Loading bills...</p>

    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>

    <!-- Bills Table -->
    <table *ngIf="!loading && filteredBills.length > 0">
        <thead>
            <tr>
                <th>Bill Date</th>
                <th>Due Date</th>
                <th>Units</th>
                <th>Amount</th>
                <th>Status</th>
            </tr>
        </thead>

        <tbody>
            <tr *ngFor="let bill of filteredBills">
                <td>{{ bill.billDate }}</td>
                <td>{{ bill.dueDate }}</td>
                <td>{{ bill.unitsConsumed }}</td>
                <td>₹ {{ bill.totalAmount }}</td>
                <td>
                    <span class="status" [class.paid]="bill.status === 'PAID'" [class.due]="bill.status !== 'PAID'">
                        {{ bill.status }}
                    </span>

                    <button *ngIf="bill.status !== 'PAID'" class="pay-btn" (click)="selectBill(bill)">
                        Pay
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Pay Bill Section -->
    <!-- Payment Modal Overlay -->
<div class="modal-overlay" *ngIf="selectedBill">

  <div class="modal">

    <button class="close-btn" (click)="selectedBill = null">✕</button>

    <h3>Pay Bill</h3>

    <p><strong>Utility:</strong> {{ selectedBill.utilityType }}</p>
    <p><strong>Bill Amount:</strong> ₹ {{ selectedBill.totalAmount }}</p>

    <label>Amount</label>
    <input type="number" [(ngModel)]="payment.amount" min="1" />

    <label>Payment Mode</label>
    <select [(ngModel)]="payment.paymentMode">
      <option *ngFor="let mode of paymentModes" [value]="mode">
        {{ mode }}
      </option>
    </select>

    <button class="pay-now" (click)="makePayment()" [disabled]="paying">
      {{ paying ? 'Processing...' : 'Pay Now' }}
    </button>

    <p class="success" *ngIf="paymentMessage && !paying">
      {{ paymentMessage }}
    </p>

  </div>

</div>

    <p *ngIf="!loading && filteredBills.length === 0" class="empty">
        No {{ activeUtility.toLowerCase() }} bills available
    </p>

</div>